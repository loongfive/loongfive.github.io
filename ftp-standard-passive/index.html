
<!DOCTYPE html>
<html>

<head>

<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>FTP主动模式(PORT)与被动模式(PASV) - 小徐de私地</title>
<link rel="stylesheet" href="/css/style.min.css">
<meta name="applicable-device" content="pc,mobile">
<meta name="description" content="FTP是文件传输协议的简称，ftp传输协议有着众多的优点所以传输文件时使用ftp协议的软件很多，ftp协议使用的端口是21（也称为控制端口），其实还有一个数据端口20，根据FTP工作方式的不同，数据端口也不都是20，主动模式的被动模式使用的数据端口是不一样的，下面我就一步一步介绍主动ftp模式和被动ftp模式的区别：  ###一、什么是主动FTP   主动模式的FTP工作原理：客户端从一个任意的非">
<meta property="og:type" content="article">
<meta property="og:title" content="FTP主动模式(PORT)与被动模式(PASV)">
<meta property="og:url" content="https://xusl.top/ftp-standard-passive/index.html">
<meta property="og:site_name" content="小徐de私地">
<meta property="og:description" content="FTP是文件传输协议的简称，ftp传输协议有着众多的优点所以传输文件时使用ftp协议的软件很多，ftp协议使用的端口是21（也称为控制端口），其实还有一个数据端口20，根据FTP工作方式的不同，数据端口也不都是20，主动模式的被动模式使用的数据端口是不一样的，下面我就一步一步介绍主动ftp模式和被动ftp模式的区别：  ###一、什么是主动FTP   主动模式的FTP工作原理：客户端从一个任意的非">
<meta property="og:locale">
<meta property="article:published_time" content="2017-03-13T11:22:00.000Z">
<meta property="article:modified_time" content="2023-10-31T08:15:42.552Z">
<meta property="article:tag" content="服务器">
<meta property="article:tag" content="网络">
<meta name="twitter:card" content="summary">
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-B58Y4W1FKN"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-B58Y4W1FKN');
</script>
<meta name="generator" content="Hexo 6.3.0"></head>

<body>

    <div class="wrapper">
        <header>
            <h2><a href="/">小徐de私地</a></h2>
            <p>越学习，越发现自己的无知 ...</p>
        </header>

        <article>
            <h1>FTP主动模式(PORT)与被动模式(PASV)</h1>
            <p>2017年03月13日</p>
            <div class="content">
                <p>FTP是文件传输协议的简称，ftp传输协议有着众多的优点所以传输文件时使用ftp协议的软件很多，ftp协议使用的端口是21（也称为控制端口），其实还有一个数据端口20，根据FTP工作方式的不同，数据端口也不都是20，主动模式的被动模式使用的数据端口是不一样的，下面我就一步一步介绍主动ftp模式和被动ftp模式的区别： </p>
<p>###一、什么是主动FTP  </p>
<p>主动模式的FTP工作原理：客户端从一个任意的非特权端口N连接到FTP服务器的命令端口，也就是21端口。然后客户端开始监听端口N+1，并发送FTP命令“port N+1”到FTP服务器。接着服务器会从它自己的数据端口（20）连接到客户端指定的数据端口（N+1）。</p>
<p>针对FTP服务器前面的防火墙来说，必须允许以下通讯才能支持主动方式FTP：    </p>
<p>1、 任何大于1024的端口到FTP服务器的21端口。（客户端初始化的连接）  </p>
<p>2、 FTP服务器的21端口到大于1024的端口。 （服务器响应客户端的控制端口） </p>
<p>3、 FTP服务器的20端口到大于1024的端口。（服务器端初始化数据连接到客户端的数据端口）</p>
<p>4、 大于1024端口到FTP服务器的20端口（客户端发送ACK响应到服务器的数据端口） </p>
<p>###二、什么是被动FTP  </p>
<p>为了解决服务器发起到客户的连接的问题，人们开发了一种不同的FTP连接方式。这就是所谓的被动方式，或者叫做PASV，当客户端通知服务器它处于被动模式时才启用。</p>
<p>在被动方式FTP中，命令连接和数据连接都由客户端发起，这样就可以解决从服务器到客户端的数据端口的入方向连接被防火墙过滤掉的问题。</p>
<p>当开启一个 FTP连接时，客户端打开两个任意的非特权本地端口（N &gt; 1024和N+1）。第一个端口连接服务器的21端口，但与主动方式的FTP不同，客户端不会提交PORT命令并允许服务器来回连它的数据端口，而是提交 PASV命令。这样做的结果是服务器会开启一个任意的非特权端口（P &gt; 1024），并发送PORT P命令给客户端。然后客户端发起从本地端口N+1到服务器的端口P的连接用来传送数据。  </p>
<p>对于服务器端的防火墙来说，必须允许下面的通讯才能支持被动方式的FTP:     </p>
<p>1、 从任何大于1024的端口到服务器的21端口（客户端初始化的连接）  </p>
<p>2、 服务器的21端口到任何大于1024的端口（服务器响应到客户端的控制端口的连接） </p>
<p>3、 从任何大于1024端口到服务器的大于1024端口（客户端初始化数据连接到服务器指定的任意端口）</p>
<p>4、 服务器的大于1024端口到远程的大于1024的端口（服务器发送ACK响应和数据到客户端的数据端口）</p>
<p>以上关于主动和被动FTP的解释，可以简单概括为以下两点：</p>
<p><strong>1、主动FTP：</strong></p>
<p>命令连接：客户端 &gt;1024端口 -&gt; 服务器 21端口  </p>
<p>数据连接：客户端 &gt;1024端口 &lt;- 服务器 20端口 </p>
<p><strong>2、被动FTP：</strong></p>
<p>命令连接：客户端 &gt;1024端口 -&gt; 服务器 21端口 </p>
<p>数据连接：客户端 &gt;1024端口 -&gt; 服务器 &gt;1024端口</p>
<p>###三、主动模式ftp与被动模式FTP优点和缺点：       </p>
<p>主动FTP对FTP服务器的管理和安全很有利，但对客户端的管理不利。因为FTP服务器企图与客户端的高位随机端口建立连接，而这个端口很有可能被客户端的防火墙阻塞掉。被动FTP对FTP客户端的管理有利，但对服务器端的管理不利。因为客户端要与服务器端建立两个连接，其中一个连到一个高位随机端口，而这个端口很有可能被服务器端的防火墙阻塞掉。</p>

            </div>
            <div class="tag">
                
                <a href="/tags/%E6%9C%8D%E5%8A%A1%E5%99%A8/">服务器</a>
                
                <a href="/tags/%E7%BD%91%E7%BB%9C/">网络</a>
                
            </div>
        </article>
        <div class="page">
            
            <a href="/pm2/" title="pm2简易使用教程">上一篇</a>
            
            
            <a href="/wndr4300-openwrt-shadowsocks/" title="NETGEAR 网件WNDR4300刷openwrt shadowsocks科学上网">下一篇</a>
            
        </div>

        <footer>
            <p>© 2015 小徐de私地 Powered by Hexo .</p>
        </footer>
    </div>

    <script src="/js/app.js"></script>

</body>

</html>
